<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
 xmlns:viewmodels="clr-namespace:NotenManager.ViewModels"
 xmlns:models="clr-namespace:NotenManager.Models"
 xmlns:converters="clr-namespace:NotenManager.Converters"
 xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Maui;assembly=LiveChartsCore.SkiaSharpView.Maui"
 x:Class="NotenManager.MainPage"
 x:DataType="viewmodels:MainViewModel"
 Shell.NavBarIsVisible="False"
 Shell.TabBarIsVisible="False">

 <ContentPage.Resources>
 <ResourceDictionary>
 <converters:SubjectColorConverter x:Key="ColorConverter"/>
 <converters:PageVisibilityConverter x:Key="PageVisibilityConverter"/>
 <converters:IsNullConverter x:Key="IsNullConverter"/>
 <converters:IsNotNullConverter x:Key="IsNotNullConverter"/>
 <converters:StringToBoolConverter x:Key="StringToBoolConverter"/>
 <converters:NoteGradeDisplayConverter x:Key="NoteGradeDisplayConverter"/>
 </ResourceDictionary>
 </ContentPage.Resources>

 <Grid>
 <Grid.ColumnDefinitions>
 <ColumnDefinition Width="280"/>
 <ColumnDefinition Width="*"/>
 </Grid.ColumnDefinitions>

 <!-- Sidebar -->
 <Grid Grid.Column="0">
 <Grid.Background>
 <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
 <GradientStop Color="#667eea" Offset="0.0" />
 <GradientStop Color="#764ba2" Offset="1.0" />
 </LinearGradientBrush>
 </Grid.Background>

 <VerticalStackLayout Padding="20,30" Spacing="10">
 <Label Text="ğŸ“Š NotenManager" 
 FontSize="24" 
 FontAttributes="Bold" 
 TextColor="White" 
 Margin="0,0,0,30"/>

 <Frame x:Name="OverviewFrame" BackgroundColor="Transparent" 
 Padding="20,16"
 CornerRadius="10"
 HasShadow="False"
 Margin="0,0,0,10">
 <Frame.Triggers>
 <DataTrigger TargetType="Frame"
 Binding="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Overview}"
 Value="True">
 <Setter Property="BackgroundColor" Value="#33ffffff" />
 <Setter Property="HasShadow" Value="True" />
 </DataTrigger>
 </Frame.Triggers>
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding NavigateToOverviewCommand}"/>
 </Frame.GestureRecognizers>
 <HorizontalStackLayout Spacing="12">
 <Label Text="ğŸ " FontSize="20" VerticalOptions="Center"/>
 <Label Text="Ãœbersicht" FontSize="15" TextColor="White" FontAttributes="Bold" VerticalOptions="Center"/>
 </HorizontalStackLayout>
 </Frame>

 <Frame x:Name="SubjectsFrame" BackgroundColor="Transparent" 
 Padding="20,16"
 CornerRadius="10"
 HasShadow="False"
 Margin="0,0,0,10">
 <Frame.Triggers>
 <DataTrigger TargetType="Frame"
 Binding="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Subjects}"
 Value="True">
 <Setter Property="BackgroundColor" Value="#33ffffff" />
 <Setter Property="HasShadow" Value="True" />
 </DataTrigger>
 </Frame.Triggers>
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding NavigateToSubjectsCommand}"/>
 </Frame.GestureRecognizers>
 <HorizontalStackLayout Spacing="12">
 <Label Text="ğŸ“š" FontSize="20" VerticalOptions="Center"/>
 <Label Text="FÃ¤cher" FontSize="15" TextColor="White" FontAttributes="Bold" VerticalOptions="Center"/>
 </HorizontalStackLayout>
 </Frame>

 <Frame x:Name="SettingsFrame" BackgroundColor="Transparent" 
 Padding="20,16"
 CornerRadius="10"
 HasShadow="False"
   Margin="0,0,0,10">
 <Frame.Triggers>
 <DataTrigger TargetType="Frame"
 Binding="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Settings}"
 Value="True">
 <Setter Property="BackgroundColor" Value="#33ffffff" />
 <Setter Property="HasShadow" Value="True" />
 </DataTrigger>
 </Frame.Triggers>
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding NavigateToSettingsCommand}"/>
 </Frame.GestureRecognizers>
 <HorizontalStackLayout Spacing="12">
 <Label Text="âš™ï¸" FontSize="20" VerticalOptions="Center"/>
 <Label Text="Einstellungen" FontSize="15" TextColor="White" FontAttributes="Bold" VerticalOptions="Center"/>
 </HorizontalStackLayout>
 </Frame>

 <Frame x:Name="InfoFrame" BackgroundColor="Transparent" 
   Padding="20,16"
  CornerRadius="10"
  HasShadow="False"
      Margin="0,0,0,10">
<Frame.Triggers>
 <DataTrigger TargetType="Frame"
 Binding="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Info}"
 Value="True">
 <Setter Property="BackgroundColor" Value="#33ffffff" />
 <Setter Property="HasShadow" Value="True" />
 </DataTrigger>
 </Frame.Triggers>
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding NavigateToInfoCommand}"/>
  </Frame.GestureRecognizers>
  <HorizontalStackLayout Spacing="12">
       <Label Text="â„¹ï¸" FontSize="20" VerticalOptions="Center"/>
  <Label Text="Info" FontSize="15" TextColor="White" FontAttributes="Bold" VerticalOptions="Center"/>
     </HorizontalStackLayout>
   </Frame>

     <Frame x:Name="FaqFrame" BackgroundColor="Transparent" 
  Padding="20,16"
    CornerRadius="10"
  HasShadow="False"
 Margin="0,0,0,10">
     <Frame.Triggers>
 <DataTrigger TargetType="Frame"
 Binding="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Faq}"
 Value="True">
 <Setter Property="BackgroundColor" Value="#33ffffff" />
 <Setter Property="HasShadow" Value="True" />
 </DataTrigger>
 </Frame.Triggers>
 <Frame.GestureRecognizers>
<TapGestureRecognizer Command="{Binding NavigateToFaqCommand}"/>
   </Frame.GestureRecognizers>
<HorizontalStackLayout Spacing="12">
     <Label Text="â“" FontSize="20" VerticalOptions="Center"/>
<Label Text="Hilfe" FontSize="15" TextColor="White" FontAttributes="Bold" VerticalOptions="Center"/>
  </HorizontalStackLayout>
       </Frame>

 </VerticalStackLayout>
 </Grid>

 <!-- Main Content -->
 <ScrollView Grid.Column="1" Padding="40">
 <VerticalStackLayout Spacing="20">
 
<!-- Ãœbersicht Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Overview}" Spacing="30">
 <Label Text="Ãœbersicht" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <Frame CornerRadius="16" Padding="40" HasShadow="True" Margin="0,0,0,20" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}">
 <Frame.Background>
 <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
 <GradientStop Color="#667eea" Offset="0.0" />
 <GradientStop Color="#764ba2" Offset="1.0" />
 </LinearGradientBrush>
 </Frame.Background>
 <VerticalStackLayout>
 <Label Text="Gesamtdurchschnitt" FontSize="16" TextColor="White" Opacity="0.9"/>
 <Label Text="{Binding OverallAverage, StringFormat='{0:F1}'}" FontSize="64" FontAttributes="Bold" TextColor="White"/>
 </VerticalStackLayout>
 </Frame>

 <FlexLayout BindableLayout.ItemsSource="{Binding Subjects}" 
 Wrap="Wrap" 
 JustifyContent="Start" 
 AlignItems="Start"
 Direction="Row">
 <BindableLayout.ItemTemplate>
 <DataTemplate x:DataType="models:Subject">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}" 
 CornerRadius="16" 
 Padding="28" 
 Margin="0,0,24,24"
 WidthRequest="280"
 HasShadow="True">
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=NavigateToNotesCommand}" 
 CommandParameter="{Binding .}"/>
 </Frame.GestureRecognizers>
 <VerticalStackLayout Spacing="12">
 <Grid>
 <Grid.ColumnDefinitions>
 <ColumnDefinition Width="*"/>
 <ColumnDefinition Width="Auto"/>
 </Grid.ColumnDefinitions>
 <Ellipse Grid.Column="0"
 Fill="{Binding Color, Converter={StaticResource ColorConverter}}"
 WidthRequest="60"
 HeightRequest="60"
 HorizontalOptions="Start"/>
 <Label Grid.Column="1" Text="â†’" FontSize="20" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}" VerticalOptions="Start"/>
 </Grid>
 <Label Text="{Binding Name}" FontSize="22" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="{Binding LessonsPerWeek, StringFormat='{0} Lektionen pro Woche'}" FontSize="13" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 <Label Text="{Binding Average, StringFormat='{0:F1}'}" FontSize="48" FontAttributes="Bold" TextColor="{StaticResource Primary}"/>
 <Label Text="{Binding Notes.Count, StringFormat='{0} Noten'}" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 </VerticalStackLayout>
 </Frame>
 </DataTemplate>
 </BindableLayout.ItemTemplate>
 </FlexLayout>
 </VerticalStackLayout>

 <!-- FÃ¤cher Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Subjects}" Spacing="30">
 <Grid>
 <Label Text="FÃ¤cher" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Button Text="+ Fach hinzufÃ¼gen" 
 Command="{Binding ShowAddSubjectModalCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="10"
 Padding="14,14"
 FontAttributes="Bold"
 HorizontalOptions="End"/>
 </Grid>

 <FlexLayout BindableLayout.ItemsSource="{Binding Subjects}" 
 Wrap="Wrap" 
 JustifyContent="Start"
 Direction="Row">
 <BindableLayout.ItemTemplate>
 <DataTemplate x:DataType="models:Subject">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}" 
 CornerRadius="16" 
 Padding="32" 
 Margin="0,0,24,24"
 WidthRequest="320"
 HasShadow="True">
 <VerticalStackLayout Spacing="20">
 <Grid>
 <Ellipse Fill="{Binding Color, Converter={StaticResource ColorConverter}}"
 WidthRequest="60"
 HeightRequest="60"
 HorizontalOptions="Start"/>
 <Button Text="âœ•" 
 BackgroundColor="#ff6b6b"
 TextColor="White"
 CornerRadius="6"
 Padding="8,8"
 FontSize="14"
 HorizontalOptions="End"
 VerticalOptions="Start"
 Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=DeleteSubjectCommand}"
 CommandParameter="{Binding .}"/>
 </Grid>
 
<VerticalStackLayout>
 <Label Text="{Binding Name}" FontSize="22" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="{Binding LessonsPerWeek, StringFormat='{0} Lektionen pro Woche'}" FontSize="13" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 </VerticalStackLayout>

 <BoxView HeightRequest="1" BackgroundColor="{StaticResource Gray200}"/>

 <Grid>
 <VerticalStackLayout HorizontalOptions="Start">
 <Label Text="Durchschnitt" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 <Label Text="{Binding Average, StringFormat='{0:F1}'}" FontSize="32" FontAttributes="Bold" TextColor="{StaticResource Primary}"/>
 </VerticalStackLayout>
 <Button Text="â†’" 
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="10,10"
 FontSize="18"
 HorizontalOptions="End"
 VerticalOptions="End"
 Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=NavigateToNotesCommand}"
 CommandParameter="{Binding .}"/>
 </Grid>
 </VerticalStackLayout>
 </Frame>
 </DataTemplate>
 </BindableLayout.ItemTemplate>
 </FlexLayout>
 </VerticalStackLayout>

 <!-- Noten Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Notes}" Spacing="30">
<Button Text="â† ZurÃ¼ck zur Ãœbersicht"
 Command="{Binding NavigateToOverviewCommand}"
 BackgroundColor="Transparent"
 TextColor="#667eea"
 FontAttributes="Bold"
 HorizontalOptions="Start"
 Margin="0,0,0,10"/>

 <Grid>
 <Label Text="{Binding SelectedSubject.Name}" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Ellipse Fill="{Binding SelectedSubject.Color, Converter={StaticResource ColorConverter}}"
 WidthRequest="60"
 HeightRequest="60"
 HorizontalOptions="End"/>
 </Grid>

 <Grid ColumnDefinitions="*,*" ColumnSpacing="40">
 <!-- Graph Container -->
 <Frame Grid.Column="0" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True">
 <VerticalStackLayout>
 <Label Text="Notenentwicklung" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" Margin="0,0,0,20"/>
 
 <!-- LiveCharts CartesianChart with integrated Y-axis -->
 <lvc:CartesianChart Series="{Binding Series}"
 XAxes="{Binding XAxes}"
 YAxes="{Binding YAxes}"
 HeightRequest="300"
 TooltipPosition="Top"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"/>
 
 <!-- Legende -->
 <Label Text="Legende" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}" Margin="10,10,0,5"
 IsVisible="{Binding ChartLegendItems, Converter={StaticResource IsNotNullConverter}}"/>
 <ScrollView MaximumHeightRequest="120" Margin="0,0,0,0">
 <VerticalStackLayout BindableLayout.ItemsSource="{Binding ChartLegendItems}" 
 Spacing="6">
 <BindableLayout.ItemTemplate>
 <DataTemplate x:DataType="models:ChartLegendItem">
 <Grid ColumnDefinitions="30,100,*,50,60" ColumnSpacing="8" Padding="4,2">
 <Grid.GestureRecognizers>
 <TapGestureRecognizer Tapped="OnLegendItemTapped" CommandParameter="{Binding .}" />
 </Grid.GestureRecognizers>
 <Label Grid.Column="0"
 Text="{Binding Number}" 
 FontSize="12" 
 TextColor="White"
 BackgroundColor="#667eea"
 FontAttributes="Bold"
 HorizontalOptions="Center"
 VerticalOptions="Center"
 WidthRequest="24"
 HeightRequest="24"
 HorizontalTextAlignment="Center"
 VerticalTextAlignment="Center">
 <Label.Clip>
 <EllipseGeometry Center="12,12" RadiusX="12" RadiusY="12"/>
 </Label.Clip>
 </Label>
 <Label Grid.Column="1"
 Text="{Binding Note.Type}" 
 FontSize="12" 
 TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"
 VerticalOptions="Center"/>
 <Label Grid.Column="2"
 Text="{Binding Note.Date, StringFormat='{0:dd.MM.yy}'}" 
 FontSize="12" 
 TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"
 VerticalOptions="Center"/>
 <Label Grid.Column="3"
 Text="{Binding Note, Converter={StaticResource NoteGradeDisplayConverter}}" 
 FontSize="12" 
 TextColor="{StaticResource Primary}"
 FontAttributes="Bold"
 VerticalOptions="Center"
 HorizontalTextAlignment="End"/>
 <Label Grid.Column="4"
 Text="{Binding Average, StringFormat='Ã˜ {0:F2}'}" 
 FontSize="12" 
 TextColor="{StaticResource Primary}"
 FontAttributes="Bold"
 VerticalOptions="Center"
 HorizontalTextAlignment="End"/>
 </Grid>
 </DataTemplate>
 </BindableLayout.ItemTemplate>
 </VerticalStackLayout>
 </ScrollView>
 </VerticalStackLayout>
 </Frame>

 <!-- Notes List -->
 <Frame Grid.Column="1" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True">
 <VerticalStackLayout Spacing="24">
 <Grid>
 <Label Text="Noten" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Button Text="+ Neue Note"
 Command="{Binding ShowAddNoteModalCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 FontSize="14"
 FontAttributes="Bold"
 HorizontalOptions="End"/>
 </Grid>

 <ScrollView HeightRequest="400">
 <VerticalStackLayout BindableLayout.ItemsSource="{Binding SelectedSubject.Notes}" Spacing="12">
 <BindableLayout.ItemTemplate>
 <DataTemplate x:DataType="models:Note">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 CornerRadius="10" 
 Padding="16" 
 HasShadow="False"
 BorderColor="#667eea">
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=ShowEditNoteModalCommand}"
 CommandParameter="{Binding .}"/>
 </Frame.GestureRecognizers>
 <Grid ColumnDefinitions="*,Auto,Auto">
 <VerticalStackLayout Grid.Column="0">
 <Label Text="{Binding Type}" FontSize="15" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="{Binding Date, StringFormat='{0:dd. MMMM yyyy}'}" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 </VerticalStackLayout>
 <Label Grid.Column="1" 
 Text="{Binding ., Converter={StaticResource NoteGradeDisplayConverter}}"
 FontSize="28" 
 FontAttributes="Bold" 
 TextColor="{StaticResource Primary}" 
 Margin="24,0"
 VerticalOptions="Center"/>
 <Button Grid.Column="2" 
 Text="â‹¯"
 BackgroundColor="White"
 TextColor="#667eea"
 BorderColor="#ddd"
 BorderWidth="1"
 CornerRadius="6"
 Padding="8,8"
 FontSize="16"
 VerticalOptions="Center"
 Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=ShowEditNoteModalCommand}"
 CommandParameter="{Binding .}"/>
 </Grid>
 </Frame>
</DataTemplate>
 </BindableLayout.ItemTemplate>
 <BindableLayout.EmptyView>
 <VerticalStackLayout Padding="40" HorizontalOptions="Center">
 <Label Text="ğŸ“" FontSize="32" HorizontalOptions="Center" Margin="0,0,0,10"/>
 <Label Text="Noch keine Noten vorhanden" FontSize="14" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}" HorizontalOptions="Center"/>
 </VerticalStackLayout>
 </BindableLayout.EmptyView>
 </VerticalStackLayout>
 </ScrollView>
 </VerticalStackLayout>
 </Frame>
 </Grid>
 </VerticalStackLayout>

 <!-- Settings Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Settings}" Spacing="30">
 <Label Text="Einstellungen" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <!-- Profil Section -->
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True" WidthRequest="800" HorizontalOptions="Start">
 <VerticalStackLayout Spacing="20">
 <Label Text="ğŸ‘¤ Profil" FontSize="18" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <VerticalStackLayout>
 <Label Text="Name" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry x:Name="SettingsUserNameEntry"
 Text="{Binding Settings.UserName, Mode=TwoWay}" 
 Placeholder="Max Mustermann" 
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 Margin="0,8,0,0"
 TextChanged="OnSettingsUserName_TextChanged"
 MaxLength="50"/>
 <Label Text="{Binding SettingsUserNameError}" 
 FontSize="12" 
 TextColor="#ff6b6b" 
 IsVisible="{Binding SettingsUserNameError, Converter={StaticResource IsNotNullConverter}}" 
 Margin="0,4,0,0"/>
 </VerticalStackLayout>

 <VerticalStackLayout>
 <Label Text="Klasse" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry x:Name="SettingsClassNameEntry"
 Text="{Binding Settings.ClassName, Mode=TwoWay}" 
 Placeholder="z.B. 10a" 
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 Margin="0,8,0,0"
 TextChanged="OnSettingsClassName_TextChanged"
 MaxLength="20"/>
 <Label Text="{Binding SettingsClassNameError}" 
 FontSize="12" 
 TextColor="#ff6b6b" 
 IsVisible="{Binding SettingsClassNameError, Converter={StaticResource IsNotNullConverter}}" 
 Margin="0,4,0,0"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <!-- Erscheinungsbild Section -->
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True" WidthRequest="800" HorizontalOptions="Start">
 <VerticalStackLayout Spacing="20">
 <Label Text="ğŸ¨ Erscheinungsbild" FontSize="18" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <HorizontalStackLayout Spacing="12">
 <Label Text="Dark Mode" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Switch IsToggled="{Binding IsDarkMode}" Toggled="OnDarkModeToggled"/>
 </HorizontalStackLayout>

 <VerticalStackLayout Spacing="10">
 <Label Text="Diagramm-Stil" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Picker ItemsSource="{Binding AvailableChartStyles}" 
 SelectedItem="{Binding Settings.ChartStyle, Mode=TwoWay}"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"
 FontSize="14"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <!-- Notensystem Section -->
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True" WidthRequest="800" HorizontalOptions="Start">
 <VerticalStackLayout Spacing="20">
 <Label Text="ğŸ“‹ Notensystem" FontSize="18" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <VerticalStackLayout Spacing="12">
 <Label Text="System wÃ¤hlen:" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <Picker ItemsSource="{Binding AvailableGradingSystems}" 
 SelectedItem="{Binding Settings.GradingSystem, Mode=TwoWay}"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"
 FontSize="14"/>
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="10">
 <Label Text="Zieldurchschnitt" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding Settings.TargetAverage, Mode=TwoWay}" 
 Placeholder="3.0" 
 Keyboard="Numeric"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 Margin="0,8,0,0"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <!-- Benachrichtigungen Section -->
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True" WidthRequest="800" HorizontalOptions="Start">
 <VerticalStackLayout Spacing="20">
 <Label Text="ğŸ”” Benachrichtigungen" FontSize="18" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <HorizontalStackLayout Spacing="12">
 <Label Text="Benachrichtigungen aktivieren" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Switch IsToggled="{Binding Settings.ShowNotifications, Mode=TwoWay}"/>
 </HorizontalStackLayout>

 <VerticalStackLayout Spacing="10">
 <HorizontalStackLayout Spacing="12">
 <Label Text="Erinnerungszeit:" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Label Text="{Binding NotificationTimeDisplay}" 
 FontSize="14" 
 TextColor="{StaticResource Primary}"
 FontAttributes="Bold"
 VerticalOptions="Center"/>
 </HorizontalStackLayout>
 <Slider x:Name="NotificationSlider"
 Minimum="0" 
 Maximum="23" 
 Value="{Binding Settings.NotificationTime, Mode=TwoWay}"
 ValueChanged="OnNotificationTimeChanged"
 MinimumTrackColor="{StaticResource Primary}"
 MaximumTrackColor="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
 ThumbColor="{StaticResource Primary}"
 Margin="0,8,0,0"/>
 <HorizontalStackLayout Spacing="580" HorizontalOptions="Center">
 <Label Text="00:00" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 <Label Text="23:00" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 </HorizontalStackLayout>
 <Label Text="â„¹ï¸ Benachrichtigungen sind derzeit nur eine UI-Vorschau. Die Funktion wird spÃ¤ter implementiert." 
 FontSize="11" 
 TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"
 Margin="0,8,0,0"
 HorizontalTextAlignment="Center"/>
 </VerticalStackLayout>

 <HorizontalStackLayout Spacing="12">
 <Label Text="WÃ¶chentliche Zusammenfassung" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Switch IsToggled="{Binding Settings.ShowWeeklySummary, Mode=TwoWay}"/>
 </HorizontalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <!-- Speichern Button -->
 <Button Text="Einstellungen speichern" 
 Command="{Binding SaveSettingsCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="10"
 Padding="16,14"
 FontAttributes="Bold"
 HorizontalOptions="Start"
 WidthRequest="250"/>

 </VerticalStackLayout>

 <!-- Info Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Info}" Spacing="30">
 <Label Text="Info" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <Frame CornerRadius="16" Padding="30" HasShadow="True">
 <Frame.Background>
 <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
 <GradientStop Color="#667eea" Offset="0.0" />
 <GradientStop Color="#764ba2" Offset="1.0" />
 </LinearGradientBrush>
 </Frame.Background>
 <VerticalStackLayout Spacing="15">
 <Label Text="NotenManager" FontSize="32" FontAttributes="Bold" TextColor="White"/>
 <Label Text="Version 1.0.0" FontSize="16" TextColor="White" Opacity="0.9"/>
 <Label Text="von realMagmaKing" FontSize="14" TextColor="White" Opacity="0.8" Margin="0,10,0,0"/>
 </VerticalStackLayout>
 </Frame>

 <Frame CornerRadius="16" Padding="28" HasShadow="True" WidthRequest="800" HorizontalOptions="Start" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}">
 <VerticalStackLayout Spacing="15">
 <Label Text="Features" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="â€¢ Notenverwaltung nach Faechern" FontSize="15" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="â€¢ Mehrere Notensysteme" FontSize="15" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="â€¢ Statistiken und Diagramme" FontSize="15" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="â€¢ Dark Mode" FontSize="15" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 </VerticalStackLayout>
 </Frame>
 </VerticalStackLayout>

 <!-- FAQ Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Faq}" Spacing="30">
 <Label Text="Hilfe" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <ScrollView HeightRequest="600">
 <VerticalStackLayout Spacing="16">
 
 <!-- FAQ 1 -->
 <Frame CornerRadius="12" Padding="0" HasShadow="True" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}">
 <VerticalStackLayout Spacing="0">
 <Grid Padding="20">
 <Grid.GestureRecognizers>
 <TapGestureRecognizer Tapped="OnFaq1Tapped"/>
 </Grid.GestureRecognizers>
 <Label Text="Wie erstelle ich ein Fach?" FontSize="18" FontAttributes="Bold" TextColor="#667eea" VerticalOptions="Center"/>
 <Label x:Name="Faq1Arrow" Text="â–¼" FontSize="20" TextColor="#667eea" HorizontalOptions="End" VerticalOptions="Center"/>
 </Grid>
 <VerticalStackLayout x:Name="Faq1Answer" IsVisible="False" Padding="20,0,20,20" Spacing="10">
 <BoxView HeightRequest="1" Color="{StaticResource Gray200}" Margin="0,0,0,10"/>
 <Label Text="Gehe zur Faecher Seite und klicke auf + Fach hinzufuegen. Gib einen Namen ein und die Lektionen pro Woche." FontSize="14" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" LineHeight="1.5"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <!-- FAQ 2 -->
 <Frame CornerRadius="12" Padding="0" HasShadow="True" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}">
 <VerticalStackLayout Spacing="0">
 <Grid Padding="20">
 <Grid.GestureRecognizers>
 <TapGestureRecognizer Tapped="OnFaq2Tapped"/>
 </Grid.GestureRecognizers>
 <Label Text="Wie fuege ich eine Note hinzu?" FontSize="18" FontAttributes="Bold" TextColor="#667eea" VerticalOptions="Center"/>
 <Label x:Name="Faq2Arrow" Text="â–¼" FontSize="20" TextColor="#667eea" HorizontalOptions="End" VerticalOptions="Center"/>
 </Grid>
 <VerticalStackLayout x:Name="Faq2Answer" IsVisible="False" Padding="20,0,20,20" Spacing="10">
 <BoxView HeightRequest="1" Color="{StaticResource Gray200}" Margin="0,0,0,10"/>
 <Label Text="Klicke auf ein Fach und dann auf + Neue Note. Gib Typ, Note und Datum ein." FontSize="14" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" LineHeight="1.5"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <!-- FAQ 3 -->
 <Frame CornerRadius="12" Padding="0" HasShadow="True" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}">
 <VerticalStackLayout Spacing="0">
 <Grid Padding="20">
 <Grid.GestureRecognizers>
 <TapGestureRecognizer Tapped="OnFaq3Tapped"/>
 </Grid.GestureRecognizers>
 <Label Text="Welche Notensysteme gibt es?" FontSize="18" FontAttributes="Bold" TextColor="#667eea" VerticalOptions="Center"/>
 <Label x:Name="Faq3Arrow" Text="â–¼" FontSize="20" TextColor="#667eea" HorizontalOptions="End" VerticalOptions="Center"/>
 </Grid>
 <VerticalStackLayout x:Name="Faq3Answer" IsVisible="False" Padding="20,0,20,20" Spacing="10">
 <BoxView HeightRequest="1" Color="{StaticResource Gray200}" Margin="0,0,0,10"/>
 <Label Text="Schweiz (6-1), Deutschland (1-6), USA (A-F), Prozent (0-100%). Du kannst das System in den Einstellungen aendern." FontSize="14" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" LineHeight="1.5"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <!-- FAQ 4 -->
 <Frame CornerRadius="12" Padding="0" HasShadow="True" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}">
 <VerticalStackLayout Spacing="0">
 <Grid Padding="20">
 <Grid.GestureRecognizers>
 <TapGestureRecognizer Tapped="OnFaq4Tapped"/>
 </Grid.GestureRecognizers>
 <Label Text="Wo werden meine Daten gespeichert?" FontSize="18" FontAttributes="Bold" TextColor="#667eea" VerticalOptions="Center"/>
 <Label x:Name="Faq4Arrow" Text="â–¼" FontSize="20" TextColor="#667eea" HorizontalOptions="End" VerticalOptions="Center"/>
 </Grid>
 <VerticalStackLayout x:Name="Faq4Answer" IsVisible="False" Padding="20,0,20,20" Spacing="10">
 <BoxView HeightRequest="1" Color="{StaticResource Gray200}" Margin="0,0,0,10"/>
 <Label Text="Alle Daten werden lokal auf deinem Geraet gespeichert. Keine Cloud, keine Drittanbieter." FontSize="14" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" LineHeight="1.5"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <!-- FAQ 5 -->
 <Frame CornerRadius="12" Padding="0" HasShadow="True" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}">
 <VerticalStackLayout Spacing="0">
 <Grid Padding="20">
 <Grid.GestureRecognizers>
 <TapGestureRecognizer Tapped="OnFaq5Tapped"/>
 </Grid.GestureRecognizers>
 <Label Text="Kann ich das Notensystem wechseln?" FontSize="18" FontAttributes="Bold" TextColor="#667eea" VerticalOptions="Center"/>
 <Label x:Name="Faq5Arrow" Text="â–¼" FontSize="20" TextColor="#667eea" HorizontalOptions="End" VerticalOptions="Center"/>
 </Grid>
 <VerticalStackLayout x:Name="Faq5Answer" IsVisible="False" Padding="20,0,20,20" Spacing="10">
 <BoxView HeightRequest="1" Color="{StaticResource Gray200}" Margin="0,0,0,10"/>
 <Label Text="Ja! Gehe zu Einstellungen und waehle ein anderes System. Alle Noten werden automatisch umgerechnet." FontSize="14" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" LineHeight="1.5"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 </VerticalStackLayout>
 </ScrollView>
 </VerticalStackLayout>

 </VerticalStackLayout>
</ScrollView>

 <!-- Add Subject Modal -->
 <Grid Grid.ColumnSpan="2" 
 BackgroundColor="#80000000" 
 IsVisible="{Binding IsAddSubjectModalVisible}"
 Padding="40">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 CornerRadius="16" 
 Padding="24" 
 WidthRequest="500" 
 HorizontalOptions="Center" 
 VerticalOptions="Center"
 HasShadow="True">
 <ScrollView>
 <VerticalStackLayout Spacing="20">
 <Label Text="Neues Fach hinzufÃ¼gen" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <VerticalStackLayout>
 <Label Text="Fachname" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewSubjectName, Mode=TwoWay}" Placeholder="z.B. Englisch" Margin="0,8,0,0" TextChanged="OnNewSubjectName_TextChanged"/>
 <Label Text="{Binding NewSubjectNameError}" FontSize="12" TextColor="#ff6b6b" IsVisible="{Binding NewSubjectNameError, Converter={StaticResource IsNotNullConverter}}" />
 </VerticalStackLayout>

 <VerticalStackLayout>
 <Label Text="Lektionen pro Woche" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewSubjectLessons}" Keyboard="Numeric" Placeholder="3" Margin="0,8,0,0"/>
 </VerticalStackLayout>

 <HorizontalStackLayout Spacing="12" HorizontalOptions="End" Margin="0,20,0,0">
 <Button Text="Abbrechen" 
 Command="{Binding CloseAddSubjectModalCommand}"
 BackgroundColor="#f0f0f0"
 TextColor="#333"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"/>
 <Button Text="HinzufÃ¼gen" 
 Command="{Binding AddSubjectCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"/>
 </HorizontalStackLayout>
 </VerticalStackLayout>
 </ScrollView>
 </Frame>
 </Grid>

 <!-- Add Note Modal -->
 <Grid Grid.ColumnSpan="2" 
 BackgroundColor="#80000000" 
 IsVisible="{Binding IsAddNoteModalVisible}"
 Padding="40">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 CornerRadius="16" 
 Padding="24" 
 WidthRequest="520" 
 HorizontalOptions="Center" 
 VerticalOptions="Center"
 HasShadow="True">
 <ScrollView>
 <VerticalStackLayout Spacing="20">
 <Label Text="Neue Note hinzufÃ¼gen" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <VerticalStackLayout Spacing="8">
 <Label Text="Notensart" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewNoteType, Mode=TwoWay}" 
 Placeholder="z.B. Test, Hausaufgabe" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"
 TextChanged="OnNewNoteType_TextChanged"/>
 <Label Text="{Binding NewNoteTypeError}" FontSize="12" TextColor="#ff6b6b" IsVisible="{Binding NewNoteTypeError, Converter={StaticResource IsNotNullConverter}}" />
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="8">
 <Label Text="{Binding GradeRangeLabel}" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <!-- USA System: Picker with Letter Grades -->
 <Picker x:Name="UsaGradePicker"
 IsVisible="False"
 SelectedIndex="0"
 SelectedIndexChanged="OnUsaGradePickerSelectedIndexChanged"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"
 Margin="0,8,0,0">
 <Picker.Items>
 <x:String>A (4.0 - Sehr gut)</x:String>
 <x:String>A- (3.7)</x:String>
 <x:String>B+ (3.3)</x:String>
 <x:String>B (3.0 - Gut)</x:String>
 <x:String>B- (2.7)</x:String>
 <x:String>C+ (2.3)</x:String>
 <x:String>C (2.0 - Befriedigend)</x:String>
 <x:String>C- (1.7)</x:String>
 <x:String>D+ (1.3)</x:String>
 <x:String>D (1.0 - Ausreichend)</x:String>
 <x:String>D- (0.7)</x:String>
 <x:String>F (0.0 - Nicht bestanden)</x:String>
 </Picker.Items>
 </Picker>
 
 <!-- Standard Entry for numeric input -->
 <Entry x:Name="StandardGradeEntry"
 Text="{Binding NewNoteGrade, Mode=TwoWay}" 
 Keyboard="Numeric" 
 Placeholder="z.B. 5.5" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"
 TextChanged="OnNewNoteGrade_TextChanged"
 MaxLength="6"/>
 
 <Label Text="{Binding NewNoteGradeError}" FontSize="12" TextColor="#ff6b6b" IsVisible="{Binding NewNoteGradeError, Converter={StaticResource IsNotNullConverter}}" />
 
 <!-- Hint Label for current system -->
 <Label x:Name="GradeHintLabel" 
 FontSize="11" 
 TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"
 Margin="0,4,0,0"
 HorizontalTextAlignment="Start"/>
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="8">
 <Label Text="Datum" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <DatePicker Date="{Binding NewNoteDate, Mode=TwoWay}" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"
 DateSelected="OnNewNoteDate_DateSelected"/>
 <Label Text="{Binding NewNoteDateError}" FontSize="12" TextColor="#ff6b6b" IsVisible="{Binding NewNoteDateError, Converter={StaticResource IsNotNullConverter}}" />
 </VerticalStackLayout>

 <HorizontalStackLayout Spacing="12" HorizontalOptions="End" Margin="0,30,0,0">
 <Button Text="Abbrechen" 
 Command="{Binding CloseAddNoteModalCommand}"
 BackgroundColor="#f0f0f0"
 TextColor="#333"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"/>
 <Button Text="HinzufÃ¼gen" 
 Command="{Binding AddNoteCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"/>
 </HorizontalStackLayout>
 </VerticalStackLayout>
 </ScrollView>
 </Frame>
 </Grid>

 <!-- Edit Note Modal -->
 <Grid Grid.ColumnSpan="2" 
 BackgroundColor="#80000000" 
 IsVisible="{Binding IsEditNoteModalVisible}"
 Padding="40">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 CornerRadius="16" 
 Padding="24" 
 WidthRequest="520" 
 HorizontalOptions="Center" 
 VerticalOptions="Center"
 HasShadow="True">
 <ScrollView>
 <VerticalStackLayout Spacing="20">
 <Label Text="Note bearbeiten" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <VerticalStackLayout Spacing="8">
 <Label Text="Notensart" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewNoteType, Mode=TwoWay}" 
 Placeholder="z.B. Test, Hausaufgabe" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"
 TextChanged="OnNewNoteType_TextChanged"/>
 <Label Text="{Binding NewNoteTypeError}" FontSize="12" TextColor="#ff6b6b" IsVisible="{Binding NewNoteTypeError, Converter={StaticResource IsNotNullConverter}}" />
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="8">
 <Label Text="{Binding GradeRangeLabel}" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <!-- USA System: Picker with Letter Grades -->
 <Picker x:Name="UsaGradePickerEdit"
 IsVisible="False"
 SelectedIndex="0"
 SelectedIndexChanged="OnUsaGradePickerSelectedIndexChanged"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"
 Margin="0,8,0,0">
 <Picker.Items>
 <x:String>A (4.0 - Sehr gut)</x:String>
 <x:String>A- (3.7)</x:String>
 <x:String>B+ (3.3)</x:String>
 <x:String>B (3.0 - Gut)</x:String>
 <x:String>B- (2.7)</x:String>
 <x:String>C+ (2.3)</x:String>
 <x:String>C (2.0 - Befriedigend)</x:String>
 <x:String>C- (1.7)</x:String>
 <x:String>D+ (1.3)</x:String>
 <x:String>D (1.0 - Ausreichend)</x:String>
 <x:String>D- (0.7)</x:String>
 <x:String>F (0.0 - Nicht bestanden)</x:String>
 </Picker.Items>
 </Picker>
 
 <!-- Standard Entry for numeric input -->
 <Entry x:Name="StandardGradeEntryEdit"
 Text="{Binding NewNoteGrade, Mode=TwoWay}" 
 Keyboard="Numeric" 
 Placeholder="z.B. 5.5" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"
 TextChanged="OnNewNoteGrade_TextChanged"
 MaxLength="6"/>
 
 <Label Text="{Binding NewNoteGradeError}" FontSize="12" TextColor="#ff6b6b" IsVisible="{Binding NewNoteGradeError, Converter={StaticResource IsNotNullConverter}}" />
 
 <!-- Hint Label for current system -->
 <Label x:Name="GradeHintLabelEdit" 
 FontSize="11" 
 TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"
 Margin="0,4,0,0"
 HorizontalTextAlignment="Start"/>
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="8">
 <Label Text="Datum" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <DatePicker Date="{Binding NewNoteDate, Mode=TwoWay}" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"
 DateSelected="OnNewNoteDate_DateSelected"/>
 <Label Text="{Binding NewNoteDateError}" FontSize="12" TextColor="#ff6b6b" IsVisible="{Binding NewNoteDateError, Converter={StaticResource IsNotNullConverter}}" />
 </VerticalStackLayout>

 <Grid Margin="0,30,0,0">
 <Button Text="LÃ¶schen" 
 Command="{Binding DeleteNoteFromModalCommand}"
 BackgroundColor="#ff6b6b"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"
 HorizontalOptions="Start"/>
 
 <HorizontalStackLayout Spacing="12" HorizontalOptions="End">
 <Button Text="Abbrechen" 
 Command="{Binding CloseEditNoteModalCommand}"
 BackgroundColor="#f0f0f0"
 TextColor="#333"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"/>
 <Button Text="Speichern" 
 Command="{Binding UpdateNoteCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"/>
 </HorizontalStackLayout>
 </Grid>
 </VerticalStackLayout>
 </ScrollView>
 </Frame>
 </Grid>
 </Grid>
</ContentPage>
