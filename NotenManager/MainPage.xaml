<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
 xmlns:viewmodels="clr-namespace:NotenManager.ViewModels"
 xmlns:models="clr-namespace:NotenManager.Models"
 xmlns:converters="clr-namespace:NotenManager.Converters"
 xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Maui;assembly=LiveChartsCore.SkiaSharpView.Maui"
 x:Class="NotenManager.MainPage"
 x:DataType="viewmodels:MainViewModel">

 <ContentPage.Resources>
 <converters:SubjectColorConverter x:Key="ColorConverter"/>
 <converters:PageVisibilityConverter x:Key="PageVisibilityConverter"/>
 <converters:IsNullConverter x:Key="IsNullConverter"/>
 <converters:IsNotNullConverter x:Key="IsNotNullConverter"/>
 </ContentPage.Resources>

 <Grid>
 <Grid.ColumnDefinitions>
 <ColumnDefinition Width="280"/>
 <ColumnDefinition Width="*"/>
 </Grid.ColumnDefinitions>

 <!-- Sidebar -->
 <Grid Grid.Column="0">
 <Grid.Background>
 <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
 <GradientStop Color="#667eea" Offset="0.0" />
 <GradientStop Color="#764ba2" Offset="1.0" />
 </LinearGradientBrush>
 </Grid.Background>

 <VerticalStackLayout Padding="20,30" Spacing="10">
 <Label Text="ðŸ“Š NotenManager" 
 FontSize="24" 
 FontAttributes="Bold" 
 TextColor="White" 
 Margin="0,0,0,30"/>

 <Frame x:Name="OverviewFrame" BackgroundColor="Transparent" 
 Padding="20,16"
 CornerRadius="10"
 HasShadow="False"
 Margin="0,0,0,10">
 <Frame.Triggers>
 <DataTrigger TargetType="Frame"
 Binding="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Overview}"
 Value="True">
 <Setter Property="BackgroundColor" Value="#33ffffff" />
 <Setter Property="HasShadow" Value="True" />
 </DataTrigger>
 </Frame.Triggers>
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding NavigateToOverviewCommand}"/>
 </Frame.GestureRecognizers>
 <HorizontalStackLayout Spacing="12">
 <Label Text="ðŸ " FontSize="20" VerticalOptions="Center"/>
 <Label Text="Ãœbersicht" FontSize="15" TextColor="White" FontAttributes="Bold" VerticalOptions="Center"/>
 </HorizontalStackLayout>
 </Frame>

 <Frame x:Name="SubjectsFrame" BackgroundColor="Transparent" 
 Padding="20,16"
 CornerRadius="10"
 HasShadow="False"
 Margin="0,0,0,10">
 <Frame.Triggers>
 <DataTrigger TargetType="Frame"
 Binding="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Subjects}"
 Value="True">
 <Setter Property="BackgroundColor" Value="#33ffffff" />
 <Setter Property="HasShadow" Value="True" />
 </DataTrigger>
 </Frame.Triggers>
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding NavigateToSubjectsCommand}"/>
 </Frame.GestureRecognizers>
 <HorizontalStackLayout Spacing="12">
 <Label Text="ðŸ“š" FontSize="20" VerticalOptions="Center"/>
 <Label Text="FÃ¤cher" FontSize="15" TextColor="White" FontAttributes="Bold" VerticalOptions="Center"/>
 </HorizontalStackLayout>
 </Frame>

 <Frame x:Name="SettingsFrame" BackgroundColor="Transparent" 
 Padding="20,16"
 CornerRadius="10"
 HasShadow="False">
 <Frame.Triggers>
 <DataTrigger TargetType="Frame"
 Binding="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Settings}"
 Value="True">
 <Setter Property="BackgroundColor" Value="#33ffffff" />
 <Setter Property="HasShadow" Value="True" />
 </DataTrigger>
 </Frame.Triggers>
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding NavigateToSettingsCommand}"/>
 </Frame.GestureRecognizers>
 <HorizontalStackLayout Spacing="12">
 <Label Text="âš™ï¸" FontSize="20" VerticalOptions="Center"/>
 <Label Text="Einstellungen" FontSize="15" TextColor="White" FontAttributes="Bold" VerticalOptions="Center"/>
 </HorizontalStackLayout>
 </Frame>
 </VerticalStackLayout>
 </Grid>

 <!-- Main Content -->
 <ScrollView Grid.Column="1" Padding="40">
 <VerticalStackLayout Spacing="20">
 
<!-- Ãœbersicht Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Overview}" Spacing="30">
 <Label Text="Ãœbersicht" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <Frame CornerRadius="16" Padding="40" HasShadow="True" Margin="0,0,0,20" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}">
 <Frame.Background>
 <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
 <GradientStop Color="#667eea" Offset="0.0" />
 <GradientStop Color="#764ba2" Offset="1.0" />
 </LinearGradientBrush>
 </Frame.Background>
 <VerticalStackLayout>
 <Label Text="Gesamtdurchschnitt" FontSize="16" TextColor="White" Opacity="0.9"/>
 <Label Text="{Binding OverallAverage, StringFormat='{0:F1}'}" FontSize="64" FontAttributes="Bold" TextColor="White"/>
 </VerticalStackLayout>
 </Frame>

 <FlexLayout BindableLayout.ItemsSource="{Binding Subjects}" 
 Wrap="Wrap" 
 JustifyContent="Start" 
 AlignItems="Start"
 Direction="Row">
 <BindableLayout.ItemTemplate>
 <DataTemplate x:DataType="models:Subject">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}" 
 CornerRadius="16" 
 Padding="28" 
 Margin="0,0,24,24"
 WidthRequest="280"
 HasShadow="True">
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=NavigateToNotesCommand}" 
 CommandParameter="{Binding .}"/>
 </Frame.GestureRecognizers>
 <VerticalStackLayout Spacing="12">
 <Grid>
 <Grid.ColumnDefinitions>
 <ColumnDefinition Width="*"/>
 <ColumnDefinition Width="Auto"/>
 </Grid.ColumnDefinitions>
 <Ellipse Grid.Column="0"
 Fill="{Binding Color, Converter={StaticResource ColorConverter}}"
 WidthRequest="60"
 HeightRequest="60"
 HorizontalOptions="Start"/>
 <Label Grid.Column="1" Text="â†’" FontSize="20" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}" VerticalOptions="Start"/>
 </Grid>
 <Label Text="{Binding Name}" FontSize="22" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="{Binding LessonsPerWeek, StringFormat='{0} Lektionen pro Woche'}" FontSize="13" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 <Label Text="{Binding Average, StringFormat='{0:F1}'}" FontSize="48" FontAttributes="Bold" TextColor="{StaticResource Primary}"/>
 <Label Text="{Binding Notes.Count, StringFormat='{0} Noten'}" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 </VerticalStackLayout>
 </Frame>
 </DataTemplate>
 </BindableLayout.ItemTemplate>
 </FlexLayout>
 </VerticalStackLayout>

 <!-- FÃ¤cher Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Subjects}" Spacing="30">
 <Grid>
 <Label Text="FÃ¤cher" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Button Text="+ Fach hinzufÃ¼gen" 
 Command="{Binding ShowAddSubjectModalCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="10"
 Padding="14,14"
 FontAttributes="Bold"
 HorizontalOptions="End"/>
 </Grid>

 <FlexLayout BindableLayout.ItemsSource="{Binding Subjects}" 
 Wrap="Wrap" 
 JustifyContent="Start"
 Direction="Row">
 <BindableLayout.ItemTemplate>
 <DataTemplate x:DataType="models:Subject">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}" 
 CornerRadius="16" 
 Padding="32" 
 Margin="0,0,24,24"
 WidthRequest="320"
 HasShadow="True">
 <VerticalStackLayout Spacing="20">
 <Grid>
 <Ellipse Fill="{Binding Color, Converter={StaticResource ColorConverter}}"
 WidthRequest="60"
 HeightRequest="60"
 HorizontalOptions="Start"/>
 <Button Text="âœ•" 
 BackgroundColor="#ff6b6b"
 TextColor="White"
 CornerRadius="6"
 Padding="8,8"
 FontSize="14"
 HorizontalOptions="End"
 VerticalOptions="Start"
 Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=DeleteSubjectCommand}"
 CommandParameter="{Binding .}"/>
 </Grid>
 
<VerticalStackLayout>
 <Label Text="{Binding Name}" FontSize="22" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="{Binding LessonsPerWeek, StringFormat='{0} Lektionen pro Woche'}" FontSize="13" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 </VerticalStackLayout>

 <BoxView HeightRequest="1" BackgroundColor="{StaticResource Gray200}"/>

 <Grid>
 <VerticalStackLayout HorizontalOptions="Start">
 <Label Text="Durchschnitt" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 <Label Text="{Binding Average, StringFormat='{0:F1}'}" FontSize="32" FontAttributes="Bold" TextColor="{StaticResource Primary}"/>
 </VerticalStackLayout>
 <Button Text="â†’" 
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="10,10"
 FontSize="18"
 HorizontalOptions="End"
 VerticalOptions="End"
 Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=NavigateToNotesCommand}"
 CommandParameter="{Binding .}"/>
 </Grid>
 </VerticalStackLayout>
 </Frame>
 </DataTemplate>
 </BindableLayout.ItemTemplate>
 </FlexLayout>
 </VerticalStackLayout>

 <!-- Noten Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Notes}" Spacing="30">
<Button Text="â† ZurÃ¼ck zur Ãœbersicht"
 Command="{Binding NavigateToOverviewCommand}"
 BackgroundColor="Transparent"
 TextColor="#667eea"
 FontAttributes="Bold"
 HorizontalOptions="Start"
 Margin="0,0,0,10"/>

 <Grid>
 <Label Text="{Binding SelectedSubject.Name}" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Ellipse Fill="{Binding SelectedSubject.Color, Converter={StaticResource ColorConverter}}"
 WidthRequest="60"
 HeightRequest="60"
 HorizontalOptions="End"/>
 </Grid>

 <Grid ColumnDefinitions="*,*" ColumnSpacing="40">
 <!-- Graph Container -->
 <Frame Grid.Column="0" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True">
 <VerticalStackLayout>
 <Label Text="Notenentwicklung" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" Margin="0,0,0,20"/>
 
 <!-- LiveCharts CartesianChart with integrated Y-axis -->
 <lvc:CartesianChart Series="{Binding Series}"
 XAxes="{Binding XAxes}"
 YAxes="{Binding YAxes}"
 HeightRequest="300"
 TooltipPosition="Top"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"/>
 
 <!-- Legende -->
 <Label Text="Legende" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}" Margin="10,10,0,5"
 IsVisible="{Binding ChartLegendItems, Converter={StaticResource IsNotNullConverter}}"/>
 <ScrollView MaximumHeightRequest="120" Margin="0,0,0,0">
 <VerticalStackLayout BindableLayout.ItemsSource="{Binding ChartLegendItems}" 
 Spacing="6">
 <BindableLayout.ItemTemplate>
 <DataTemplate x:DataType="models:ChartLegendItem">
 <Grid ColumnDefinitions="30,100,*,50,60" ColumnSpacing="8" Padding="4,2">
 <Grid.GestureRecognizers>
 <TapGestureRecognizer Tapped="OnLegendItemTapped" CommandParameter="{Binding .}" />
 </Grid.GestureRecognizers>
 <Label Grid.Column="0"
 Text="{Binding Number}" 
 FontSize="12" 
 TextColor="White"
 BackgroundColor="#667eea"
 FontAttributes="Bold"
 HorizontalOptions="Center"
 VerticalOptions="Center"
 WidthRequest="24"
 HeightRequest="24"
 HorizontalTextAlignment="Center"
 VerticalTextAlignment="Center">
 <Label.Clip>
 <EllipseGeometry Center="12,12" RadiusX="12" RadiusY="12"/>
 </Label.Clip>
 </Label>
 <Label Grid.Column="1"
 Text="{Binding Note.Type}" 
 FontSize="12" 
 TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"
 VerticalOptions="Center"/>
 <Label Grid.Column="2"
 Text="{Binding Note.Date, StringFormat='{0:dd.MM.yy}'}" 
 FontSize="12" 
 TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"
 VerticalOptions="Center"/>
 <Label Grid.Column="3"
 Text="{Binding Note.Grade, StringFormat='{0:F1}'}" 
 FontSize="12" 
 TextColor="{StaticResource Primary}"
 FontAttributes="Bold"
 VerticalOptions="Center"
 HorizontalTextAlignment="End"/>
 <Label Grid.Column="4"
 Text="{Binding Average, StringFormat='Ã˜ {0:F2}'}" 
 FontSize="12" 
 TextColor="{StaticResource Primary}"
 FontAttributes="Bold"
 VerticalOptions="Center"
 HorizontalTextAlignment="End"/>
 </Grid>
 </DataTemplate>
 </BindableLayout.ItemTemplate>
 </VerticalStackLayout>
 </ScrollView>
 </VerticalStackLayout>
 </Frame>

 <!-- Notes List -->
 <Frame Grid.Column="1" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True">
 <VerticalStackLayout Spacing="24">
 <Grid>
 <Label Text="Noten" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Button Text="+ Neue Note"
 Command="{Binding ShowAddNoteModalCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 FontSize="14"
 FontAttributes="Bold"
 HorizontalOptions="End"/>
 </Grid>

 <ScrollView HeightRequest="400">
 <VerticalStackLayout BindableLayout.ItemsSource="{Binding SelectedSubject.Notes}" Spacing="12">
 <BindableLayout.ItemTemplate>
 <DataTemplate x:DataType="models:Note">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 CornerRadius="10" 
 Padding="16" 
 HasShadow="False"
 BorderColor="#667eea">
 <Frame.GestureRecognizers>
 <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=ShowEditNoteModalCommand}"
 CommandParameter="{Binding .}"/>
 </Frame.GestureRecognizers>
 <Grid ColumnDefinitions="*,Auto,Auto">
 <VerticalStackLayout Grid.Column="0">
 <Label Text="{Binding Type}" FontSize="15" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Label Text="{Binding Date, StringFormat='{0:dd. MMMM yyyy}'}" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}"/>
 </VerticalStackLayout>
 <Label Grid.Column="1" 
 Text="{Binding Grade, StringFormat='{0:F1}'}" 
 FontSize="28" 
 FontAttributes="Bold" 
 TextColor="{StaticResource Primary}" 
 Margin="24,0"
 VerticalOptions="Center"/>
 <Button Grid.Column="2" 
 Text="â‹¯"
 BackgroundColor="White"
 TextColor="#667eea"
 BorderColor="#ddd"
 BorderWidth="1"
 CornerRadius="6"
 Padding="8,8"
 FontSize="16"
 VerticalOptions="Center"
 Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:MainViewModel}}, Path=ShowEditNoteModalCommand}"
 CommandParameter="{Binding .}"/>
 </Grid>
 </Frame>
</DataTemplate>
 </BindableLayout.ItemTemplate>
 <BindableLayout.EmptyView>
 <VerticalStackLayout Padding="40" HorizontalOptions="Center">
 <Label Text="ðŸ“" FontSize="32" HorizontalOptions="Center" Margin="0,0,0,10"/>
 <Label Text="Noch keine Noten vorhanden" FontSize="14" TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray300}}" HorizontalOptions="Center"/>
 </VerticalStackLayout>
 </BindableLayout.EmptyView>
 </VerticalStackLayout>
 </ScrollView>
 </VerticalStackLayout>
 </Frame>
 </Grid>
 </VerticalStackLayout>

 <!-- Settings Page -->
 <VerticalStackLayout IsVisible="{Binding CurrentPage, Converter={StaticResource PageVisibilityConverter}, ConverterParameter=Settings}" Spacing="30">
 <Label Text="Einstellungen" FontSize="42" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True" WidthRequest="800" HorizontalOptions="Start">
 <VerticalStackLayout Spacing="20">
 <Label Text="ðŸ‘¤ Profil" FontSize="18" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <VerticalStackLayout>
 <Label Text="Name" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Placeholder="Max Mustermann" BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" Margin="0,8,0,0"/>
 </VerticalStackLayout>
 </VerticalStackLayout>
 </Frame>

 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" CornerRadius="16" Padding="28" HasShadow="True" WidthRequest="800" HorizontalOptions="Start">
 <VerticalStackLayout Spacing="20">
 <Label Text="ðŸŽ¨ Erscheinungsbild" FontSize="18" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <HorizontalStackLayout Spacing="12">
 <Label Text="Dark Mode" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}" VerticalOptions="Center"/>
 <Switch IsToggled="{Binding IsDarkMode}" Toggled="OnDarkModeToggled"/>
 </HorizontalStackLayout>
 </VerticalStackLayout>
 </Frame>
 </VerticalStackLayout>

 </VerticalStackLayout>
</ScrollView>

 <!-- Add Subject Modal -->
 <Grid Grid.ColumnSpan="2" 
 BackgroundColor="#80000000" 
 IsVisible="{Binding IsAddSubjectModalVisible}"
 Padding="40">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 CornerRadius="16" 
 Padding="24" 
 WidthRequest="500" 
 HorizontalOptions="Center" 
 VerticalOptions="Center"
 HasShadow="True">
 <ScrollView>
 <VerticalStackLayout Spacing="20">
 <Label Text="Neues Fach hinzufÃ¼gen" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <VerticalStackLayout>
 <Label Text="Fachname" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewSubjectName}" Placeholder="z.B. Englisch" Margin="0,8,0,0"/>
 </VerticalStackLayout>

 <VerticalStackLayout>
 <Label Text="Lektionen pro Woche" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewSubjectLessons}" Keyboard="Numeric" Placeholder="3" Margin="0,8,0,0"/>
 </VerticalStackLayout>

 <HorizontalStackLayout Spacing="12" HorizontalOptions="End" Margin="0,20,0,0">
 <Button Text="Abbrechen" 
 Command="{Binding CloseAddSubjectModalCommand}"
 BackgroundColor="#f0f0f0"
 TextColor="#333"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"/>
 <Button Text="HinzufÃ¼gen" 
 Command="{Binding AddSubjectCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"/>
 </HorizontalStackLayout>
 </VerticalStackLayout>
 </ScrollView>
 </Frame>
 </Grid>

 <!-- Add Note Modal -->
 <Grid Grid.ColumnSpan="2" 
 BackgroundColor="#80000000" 
 IsVisible="{Binding IsAddNoteModalVisible}"
 Padding="40">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 CornerRadius="16" 
 Padding="24" 
 WidthRequest="520" 
 HorizontalOptions="Center" 
 VerticalOptions="Center"
 HasShadow="True">
 <ScrollView>
 <VerticalStackLayout Spacing="20">
 <Label Text="Neue Note hinzufÃ¼gen" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <VerticalStackLayout Spacing="8">
 <Label Text="Notensart" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewNoteType}" 
 Placeholder="z.B. Test, Hausaufgabe" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"/>
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="8">
 <Label Text="Note (1-6)" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewNoteGrade, Mode=TwoWay}" 
 Keyboard="Numeric" 
 Placeholder="2.5" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"/>
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="8">
 <Label Text="Datum" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <DatePicker Date="{Binding NewNoteDate, Mode=TwoWay}" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"/>
 </VerticalStackLayout>

 <HorizontalStackLayout Spacing="12" HorizontalOptions="End" Margin="0,30,0,0">
 <Button Text="Abbrechen" 
 Command="{Binding CloseAddNoteModalCommand}"
 BackgroundColor="#f0f0f0"
 TextColor="#333"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"/>
 <Button Text="HinzufÃ¼gen" 
 Command="{Binding AddNoteCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"/>
 </HorizontalStackLayout>
 </VerticalStackLayout>
 </ScrollView>
 </Frame>
 </Grid>

 <!-- Edit Note Modal -->
 <Grid Grid.ColumnSpan="2" 
 BackgroundColor="#80000000" 
 IsVisible="{Binding IsEditNoteModalVisible}"
 Padding="40">
 <Frame BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}" 
 CornerRadius="16" 
 Padding="24" 
 WidthRequest="520" 
 HorizontalOptions="Center" 
 VerticalOptions="Center"
 HasShadow="True">
 <ScrollView>
 <VerticalStackLayout Spacing="20">
 <Label Text="Note bearbeiten" FontSize="24" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 
 <VerticalStackLayout Spacing="8">
 <Label Text="Notensart" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewNoteType, Mode=TwoWay}" 
 Placeholder="z.B. Test, Hausaufgabe" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"/>
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="8">
 <Label Text="Note (1-6)" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <Entry Text="{Binding NewNoteGrade, Mode=TwoWay}" 
 Keyboard="Numeric" 
 Placeholder="2.5" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"/>
 </VerticalStackLayout>

 <VerticalStackLayout Spacing="8">
 <Label Text="Datum" FontSize="14" FontAttributes="Bold" TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource White}}"/>
 <DatePicker Date="{Binding NewNoteDate, Mode=TwoWay}" 
 Margin="0,8,0,0"
 BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceLight}, Dark={StaticResource SurfaceDark}}"
 HeightRequest="45"/>
 </VerticalStackLayout>

 <Grid Margin="0,30,0,0">
 <Button Text="LÃ¶schen" 
 Command="{Binding DeleteNoteFromModalCommand}"
 BackgroundColor="#ff6b6b"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"
 HorizontalOptions="Start"/>
 
 <HorizontalStackLayout Spacing="12" HorizontalOptions="End">
 <Button Text="Abbrechen" 
 Command="{Binding CloseEditNoteModalCommand}"
 BackgroundColor="#f0f0f0"
 TextColor="#333"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"/>
 <Button Text="Speichern" 
 Command="{Binding UpdateNoteCommand}"
 BackgroundColor="#667eea"
 TextColor="White"
 CornerRadius="8"
 Padding="12,12"
 WidthRequest="120"
 HeightRequest="45"/>
 </HorizontalStackLayout>
 </Grid>
 </VerticalStackLayout>
 </ScrollView>
 </Frame>
 </Grid>
 </Grid>
</ContentPage>
